# file: index.html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Configuration Hub</title>
  <style>
    :root {
      --brand-blue: #1589ee;
      --dark-blue: #16325c;
      --light-gray: #f4f6f9;
      --border-gray: #d8dde6;
      --text-dark: #1a1a1a;
      --text-light: #63737a;
      --font: Arial, sans-serif;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; font-family: var(--font); background: var(--light-gray); color: var(--text-dark); }
    .app-container { display: flex; flex-direction: column; height: 100%; }
    header { background: var(--dark-blue); color: white; padding: 0 1em; display: flex; align-items: center; height: 50px; justify-content: space-between; }
    header h1 { font-size: 1.2em; }
    .body { flex: 1; display: flex; overflow: hidden; }
    nav { width: 220px; background: var(--brand-blue); display: flex; flex-direction: column; }
    nav a { color: white; text-decoration: none; padding: 1em; }
    nav a.active, nav a:hover { background: var(--dark-blue); }
    .main { flex: 1; overflow-y: auto; padding: 1em; }
    .section { display: none; }
    .section.active { display: block; }
    .card { background: white; border: 1px solid var(--border-gray); border-radius: 4px; padding: 1em; margin-bottom: 1em; }
    h2 { margin-bottom: 0.5em; color: var(--dark-blue); }
    label { display: block; margin: 0.5em 0 0.25em; font-weight: bold; }
    input[type="text"], textarea, select, input[type="number"], input[type="date"], input[type="url"] { width: 100%; padding: 0.5em; border: 1px solid var(--border-gray); border-radius: 3px; }
    textarea { resize: vertical; height: 80px; }
    button { margin-top: 0.5em; background: var(--brand-blue); color: white; border: none; padding: 0.5em 1em; border-radius: 3px; cursor: pointer; }
    button.delete { background: #d9534f; margin-left: 0.5em; }
    button.update { background: #ffc107; color: #1a1a1a; margin-left: 0.5em;}
    table { width: 100%; border-collapse: collapse; margin-top: 0.5em; }
    th, td { border: 1px solid var(--border-gray); padding: 0.5em; text-align: left; }
    th { background: var(--light-gray); }
    .search-input { width: calc(100% - 2px); margin-bottom: 0.5em; }
    .wizard-overlay { position: fixed; top:0; left:0; right:0; bottom:0; background: rgba(0,0,0,0.4); display: none; align-items: center; justify-content: center; }
    .wizard-content { background: white; padding: 1em; border-radius: 5px; width: 600px; max-height: 90%; overflow-y: auto; }
    .wizard-step { display: none; }
    .wizard-step.active { display: block; }
    .wizard-buttons { text-align: right; margin-top: 1em; }
    .wizard-buttons button { margin-left: 0.5em; }
    .order-list { list-style: none; padding: 0; }
    .order-list li { margin: 0.25em 0; display: flex; justify-content: space-between; align-items: center; background: var(--light-gray); padding: 0.5em; border-radius: 3px; }
    .order-btn { background: transparent; border: none; cursor: pointer; color: var(--brand-blue); margin-left: 0.5em; }
    .error { color: #d9534f; font-size: 0.9em; margin-top: 0.25em; }
  </style>
</head>
<body>
  <div class="app-container">
    <header>
      <h1>Configuration Hub</h1>
      <div>User: admin | <a href="#" style="color:white;text-decoration:underline;">Logout</a></div>
    </header>
    <div class="body">
      <nav>
        <a href="#" data-target="submission-library" class="active">Submission Library</a>
        <a href="#" data-target="review-library">Review Library</a>
        <a href="#" data-target="cohorts">Cohorts</a>
        <a href="#" data-target="bundles">Submission Bundles</a>
        <a href="#" data-target="bundles">Review Bundles</a>
        <a href="#" data-target="deliverables">Deliverables</a>
      </nav>
      <div class="main">
        <!-- Submission Form Library -->
        <section id="submission-library" class="section active">
          <h2>Manage Submission Form Library</h2>
          <button id="open-lib-wizard">New Submission Form</button>
          <button id="delete-selected-sub">Delete Selected</button>
          <div class="card">
            <label for="submission-grid-search">Search Forms</label>
            <input type="text" id="submission-grid-search" class="search-input" placeholder="Search...">
            <table>
              <thead><tr><th><input type="checkbox" id="sub-select-all"></th><th>Name</th><th>Endpoint URL</th><th>Auth Type</th><th>Schema</th><th>Status</th><th>Actions</th></tr></thead>
              <tbody id="submission-grid"></tbody>
            </table>
          </div>
        </section>
        <!-- Review Form Library -->
        <section id="review-library" class="section">
          <h2>Manage Review Form Library</h2>
          <button id="open-rlib-wizard">New Review Form</button>
          <button id="delete-selected-rev">Delete Selected</button>
          <div class="card">
            <label for="review-grid-search">Search Forms</label>
            <input type="text" id="review-grid-search" class="search-input" placeholder="Search...">
            <table>
              <thead><tr><th><input type="checkbox" id="rev-select-all"></th><th>Name</th><th>Endpoint URL</th><th>Auth Type</th><th>Schema</th><th>Status</th><th>Actions</th></tr></thead>
              <tbody id="review-grid"></tbody>
            </table>
          </div>
        </section>
        <!-- Cohorts -->
        <section id="cohorts" class="section">
          <h2>Manage Cohorts</h2>
          <button id="open-cohort-wizard">New Cohort</button>
          <button id="delete-selected-cohort">Delete Selected</button>
          <div class="card">
            <table>
              <thead><tr><th><input type="checkbox" id="cohort-select-all"></th><th>Name</th><th>Description</th><th>Tags</th><th>Program</th><th>Entity Type</th><th># Entities</th><th>Actions</th></tr></thead>
              <tbody id="cohort-grid"></tbody>
            </table>
          </div>
        </section>
        <!-- Bundles -->
        <section id="bundles" class="section">
          <h2>Manage Bundles</h2>
          <button id="open-bundle-wizard">New Bundle</button>
          <button id="delete-selected-bundle">Delete Selected</button>
          <div class="card">
            <label for="bundle-grid-search">Search Bundles</label>
            <input type="text" id="bundle-grid-search" class="search-input" placeholder="Search bundles...">
            <table>
              <thead><tr><th><input type="checkbox" id="bundle-select-all"></th><th>Name</th><th>Description</th><th>Program</th><th>Tags</th><th># Submission Forms</th><th>Review Enabled</th><th># Review Forms</th><th>Actions</th></tr></thead>
              <tbody id="bundle-grid"></tbody>
            </table>
          </div>
        </section>
        <!-- Deliverables -->
        <section id="deliverables" class="section">
          <h2>Manage Deliverables</h2>
          <button id="open-deliverable-wizard">New Deliverable</button>
          <button id="delete-selected-del">Delete Selected</button>
          <div class="card">
            <label for="deliverable-grid-search">Search Deliverables</label>
            <input type="text" id="deliverable-grid-search" class="search-input" placeholder="Search...">
            <table>
              <thead><tr><th><input type="checkbox" id="del-select-all"></th><th>Name</th><th>Cohort</th><th>Bundle</th><th>Schedule</th><th>Next Run</th><th>Status</th><th>Actions</th></tr></thead>
              <tbody id="deliverable-grid"></tbody>
            </table>
          </div>
        </section>
      </div>
    </div>
  </div>

  <!-- Wizards (unchanged except submission & review support edit) -->
  <div id="lib-wizard-overlay" class="wizard-overlay">
    <div class="wizard-content">
      <div id="lw-step-1" class="wizard-step active">
        <h3>Step 1: Metadata</h3>
        <label for="lw-name">Form Name *</label>
        <input type="text" id="lw-name"><div id="lw-name-error" class="error"></div>
        <label for="lw-endpoint">Endpoint URL *</label>
        <input type="url" id="lw-endpoint"><div id="lw-endpoint-error" class="error"></div>
        <label for="lw-auth">Auth Type</label>
        <select id="lw-auth"><option value="">-- select --</option><option>API Key</option><option>OAuth2</option></select>
        <label for="lw-schema">Schema Reference</label>
        <input type="text" id="lw-schema">
      </div>
      <div id="lw-step-2" class="wizard-step">
        <h3>Step 2: Validation & Confirm</h3>
        <button id="lw-validate">Run Validation Tests</button>
        <p id="lw-validate-status"></p>
        <p><strong>Name:</strong> <span id="lw-review-name"></span></p>
        <p><strong>Endpoint:</strong> <span id="lw-review-endpoint"></span></p>
        <p><strong>Auth:</strong> <span id="lw-review-auth"></span></p>
        <p><strong>Schema:</strong> <span id="lw-review-schema"></span></p>
      </div>
      <div class="wizard-buttons">
        <button id="lw-prev">Back</button>
        <button id="lw-next">Next</button>
        <button id="lw-finish">Finish</button>
        <button id="lw-cancel">Cancel</button>
      </div>
    </div>
  </div>

  <div id="rlib-wizard-overlay" class="wizard-overlay">
    <div class="wizard-content">
      <div id="rlw-step-1" class="wizard-step active">
        <h3>Step 1: Metadata</h3>
        <label for="rlw-name">Form Name *</label>
        <input type="text" id="rlw-name"><div id="rlw-name-error" class="error"></div>
        <label for="rlw-endpoint">Endpoint URL *</label>
        <input type="url" id="rlw-endpoint"><div id="rlw-endpoint-error" class="error"></div>
        <label for="rlw-auth">Auth Type</label>
        <select id="rlw-auth"><option value="">-- select --</option><option>API Key</option><option>OAuth2</option></select>
        <label for="rlw-schema">Schema Reference</label>
        <input type="text" id="rlw-schema">
      </div>
      <div id="rlw-step-2" class="wizard-step">
        <h3>Step 2: Validation & Confirm</h3>
        <button id="rlw-validate">Run Validation Tests</button>
        <p id="rlw-validate-status"></p>
        <p><strong>Name:</strong> <span id="rlw-review-name"></span></p>
        <p><strong>Endpoint:</strong> <span id="rlw-review-endpoint"></span></p>
        <p><strong>Auth:</strong> <span id="rlw-review-auth"></span></p>
        <p><strong>Schema:</strong> <span id="rlw-review-schema"></span></p>
      </div>
      <div class="wizard-buttons">
        <button id="rlw-prev">Back</button>
        <button id="rlw-next">Next</button>
        <button id="rlw-finish">Finish</button>
        <button id="rlw-cancel">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Cohort, Bundle, Deliverable Wizards remain identical to existing logic -->

  <script>
    // Navigation
    document.querySelectorAll('nav a').forEach(a=>{
      a.onclick=e=>{
        e.preventDefault();
        document.querySelectorAll('nav a').forEach(x=>x.classList.remove('active'));
        a.classList.add('active');
        document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
        document.getElementById(a.dataset.target).classList.add('active');
      };
    });

    // Data Stores with realistic HRSA BPHC Post Award Progress Reports
    const submissionLibrary = [
      {id:'1',name:'Form 1A',endpoint:'https://api.example.com/forms/1A',auth:'API Key',schema:'form1A-schema.json',lastValidationStatus:'Passed'},
      {id:'2',name:'Consolidated Budget',endpoint:'https://api.example.com/forms/budget',auth:'OAuth2',schema:'budget-schema.json',lastValidationStatus:'Passed'},
      {id:'3',name:'BPHC Post Award Progress Report (FQHC)',endpoint:'https://api.hrsa.gov/forms/bphc-progress',auth:'API Key',schema:'bphc-progress-schema-v1.json',lastValidationStatus:'Pending'},
      {id:'4',name:'Emergency Prep Report',endpoint:'https://api.example.com/forms/emergency',auth:'OAuth2',schema:'emergency-schema.json',lastValidationStatus:'Failed'}
    ];
    const reviewLibrary = [
      {id:'1',name:'Scope PO Review',endpoint:'https://api.example.com/reviews/scope-po',auth:'API Key',schema:'scope-po-schema.json',lastValidationStatus:'Passed'},
      {id:'2',name:'Environmental Review',endpoint:'https://api.example.com/reviews/environmental',auth:'OAuth2',schema:'env-schema.json',lastValidationStatus:'Pending'},
      {id:'3',name:'BPHC Progress Review',endpoint:'https://api.hrsa.gov/reviews/bphc-progress',auth:'API Key',schema:'bphc-review-schema-v1.json',lastValidationStatus:'Passed'}
    ];
    const dataStore = {
      330:{applications:['App1','App2'],awards:['Award1'],organizations:['Org1']},
      LGP:{applications:['LGP App1'],awards:['LGP Award1'],organizations:['LGP Org1']},
      LAL:{applications:['LAL App1'],awards:['LAL Award1'],organizations:['LAL Org1']}
    };
    let cohorts = [];
    let bundles = [];
    let deliverables = [];

    // Generic render
    function renderGrid(grid, data, columns) {
      grid.innerHTML = '';
      data.forEach((item, idx) => {
        const tr = document.createElement('tr');
        let html = `<td><input type="checkbox" data-name="${item.name}"></td>`;
        columns.forEach(col=>{
          const v = typeof col==='function'?col(item):item[col]||'';
          html+=`<td>${v}</td>`;
        });
        html+=`<td><button class="update" data-name="${item.name}">Update</button><button class="delete" data-name="${item.name}">Delete</button></td>`;
        tr.innerHTML = html;
        grid.appendChild(tr);
      });
    }

    // Submission Library
    const subGrid = document.getElementById('submission-grid');
    const subSearch = document.getElementById('submission-grid-search');
    const deleteSelectedSub = document.getElementById('delete-selected-sub');
    function renderSubmissionLibrary() {
      const q = subSearch.value.toLowerCase();
      const filtered = submissionLibrary.filter(f=>f.name.toLowerCase().includes(q));
      renderGrid(subGrid, filtered, ['name','endpoint','auth','schema','lastValidationStatus']);
      deleteSelectedSub.disabled = true;
      document.getElementById('sub-select-all').checked = false;
      // per-row selection update delete button
      subGrid.querySelectorAll('input[type="checkbox"]').forEach(cb=>{
        cb.onchange = ()=> deleteSelectedSub.disabled = !subGrid.querySelectorAll('input[type="checkbox"]:checked').length;
      });
      // single delete
      subGrid.querySelectorAll('.delete').forEach(btn=>{
        btn.onclick=()=>{
          const name = btn.dataset.name;
          if(confirm(`Delete submission form "${name}"?`)){
            submissionLibrary = submissionLibrary.filter(it=>it.name!==name);
            renderSubmissionLibrary();
          }
        };
      });
      // update
      subGrid.querySelectorAll('.update').forEach(btn=>{
        btn.onclick=()=>{
          openLibWizard('edit', btn.dataset.name);
        };
      });
    }
    subSearch.oninput = renderSubmissionLibrary;
    renderSubmissionLibrary();
    // select-all & bulk delete
    document.getElementById('sub-select-all').onclick= e=>{
      const checked = e.target.checked;
      subGrid.querySelectorAll('input[type="checkbox"]').forEach(cb=>cb.checked=checked);
      deleteSelectedSub.disabled = !checked;
    };
    deleteSelectedSub.onclick=()=>{
      const selected = Array.from(subGrid.querySelectorAll('input[type="checkbox"]:checked')).map(cb=>cb.dataset.name);
      if(!selected.length){ alert('No forms selected'); return; }
      if(confirm(`Delete ${selected.length} selected submission forms?`)){
        selected.forEach(n=>{ submissionLibrary = submissionLibrary.filter(it=>it.name!==n); });
        renderSubmissionLibrary();
      }
    };

    // Review Library
    const revGrid = document.getElementById('review-grid');
    const revSearch = document.getElementById('review-grid-search');
    const deleteSelectedRev = document.getElementById('delete-selected-rev');
    function renderReviewLibrary() {
      const q = revSearch.value.toLowerCase();
      const filtered = reviewLibrary.filter(f=>f.name.toLowerCase().includes(q));
      renderGrid(revGrid, filtered, ['name','endpoint','auth','schema','lastValidationStatus']);
      deleteSelectedRev.disabled = true;
      document.getElementById('rev-select-all').checked = false;
      revGrid.querySelectorAll('input[type="checkbox"]').forEach(cb=>{
        cb.onchange = ()=> deleteSelectedRev.disabled = !revGrid.querySelectorAll('input[type="checkbox"]:checked').length;
      });
      revGrid.querySelectorAll('.delete').forEach(btn=>{
        btn.onclick=()=>{
          const name=btn.dataset.name;
          if(confirm(`Delete review form "${name}"?`)){
            reviewLibrary = reviewLibrary.filter(it=>it.name!==name);
            renderReviewLibrary();
          }
        };
      });
      revGrid.querySelectorAll('.update').forEach(btn=>{
        btn.onclick=()=>openRLibWizard('edit', btn.dataset.name);
      });
    }
    revSearch.oninput = renderReviewLibrary;
    renderReviewLibrary();
    document.getElementById('rev-select-all').onclick=e=>{
      const checked=e.target.checked;
      revGrid.querySelectorAll('input[type="checkbox"]').forEach(cb=>cb.checked=checked);
      deleteSelectedRev.disabled=!checked;
    };
    deleteSelectedRev.onclick=()=>{
      const selected = Array.from(revGrid.querySelectorAll('input[type="checkbox"]:checked')).map(cb=>cb.dataset.name);
      if(!selected.length){ alert('No forms selected'); return; }
      if(confirm(`Delete ${selected.length} selected review forms?`)){
        selected.forEach(n=>{ reviewLibrary = reviewLibrary.filter(it=>it.name!==n); });
        renderReviewLibrary();
      }
    };

    // Cohorts
    const cohGrid = document.getElementById('cohort-grid'), deleteSelectedCohort=document.getElementById('delete-selected-cohort');
    function renderCohorts(){
      renderGrid(cohGrid, cohorts, ['name',c=>c.desc,'tags',c=>c.program,'type',c=>c.entities.length]);
      deleteSelectedCohort.disabled=true;
      document.getElementById('cohort-select-all').checked=false;
      cohGrid.querySelectorAll('input[type="checkbox"]').forEach(cb=>cb.onchange=()=>deleteSelectedCohort.disabled=!cohGrid.querySelectorAll('input[type="checkbox"]:checked').length);
      cohGrid.querySelectorAll('.delete').forEach(btn=>{
        btn.onclick=()=>{
          const name=btn.dataset.name;
          if(confirm(`Delete cohort "${name}"?`)){
            cohorts=cohorts.filter(c=>c.name!==name); renderCohorts();
          }
        };
      });
      cohGrid.querySelectorAll('.update').forEach(btn=>{
        btn.onclick=()=>openCohortWizard('edit', btn.dataset.name);
      });
    }
    renderCohorts();
    document.getElementById('cohort-select-all').onclick=e=>{
      const c= e.target.checked;
      cohGrid.querySelectorAll('input[type="checkbox"]').forEach(cb=>cb.checked=c);
      deleteSelectedCohort.disabled=!c;
    };
    deleteSelectedCohort.onclick=()=>{
      const sel=Array.from(cohGrid.querySelectorAll('input[type="checkbox"]:checked')).map(cb=>cb.dataset.name);
      if(!sel.length){alert('None selected');return;}
      if(confirm(`Delete ${sel.length} cohorts?`)){ sel.forEach(n=>cohorts=cohorts.filter(c=>c.name!==n)); renderCohorts(); }
    };

    // Bundles
    const bundleGrid=document.getElementById('bundle-grid'), deleteSelectedBundle=document.getElementById('delete-selected-bundle'), bundleSearch=document.getElementById('bundle-grid-search');
    function renderBundles(){
      const q=bundleSearch.value.toLowerCase();
      const filtered=bundles.filter(b=>b.name.toLowerCase().includes(q)||b.tags.toLowerCase().includes(q));
      renderGrid(bundleGrid, filtered, ['name','desc','program','tags',b=>b.submissionForms.length,b=>b.reviewEnabled?'Yes':'No',b=>b.reviewForms.length]);
      deleteSelectedBundle.disabled=true;
      document.getElementById('bundle-select-all').checked=false;
      bundleGrid.querySelectorAll('input[type="checkbox"]').forEach(cb=>cb.onchange=()=>deleteSelectedBundle.disabled=!bundleGrid.querySelectorAll('input[type="checkbox"]:checked').length);
      bundleGrid.querySelectorAll('.delete').forEach(btn=>{
        btn.onclick=()=>{
          const name=btn.dataset.name;
          if(confirm(`Delete bundle "${name}"?`)){
            bundles=bundles.filter(b=>b.name!==name); renderBundles();
          }
        };
      });
      bundleGrid.querySelectorAll('.update').forEach(btn=>{
        btn.onclick=()=>openBundleWizard('edit', btn.dataset.name);
      });
    }
    bundleSearch.oninput=renderBundles;
    renderBundles();
    document.getElementById('bundle-select-all').onclick=e=>{
      const c=e.target.checked;
      bundleGrid.querySelectorAll('input[type="checkbox"]').forEach(cb=>cb.checked=c);
      deleteSelectedBundle.disabled=!c;
    };
    deleteSelectedBundle.onclick=()=>{
      const sel=Array.from(bundleGrid.querySelectorAll('input[type="checkbox"]:checked')).map(cb=>cb.dataset.name);
      if(!sel.length){alert('None selected');return;}
      if(confirm(`Delete ${sel.length} bundles?`)){ sel.forEach(n=>bundles=bundles.filter(b=>b.name!==n)); renderBundles(); }
    };

    // Deliverables
    const delGrid=document.getElementById('deliverable-grid'), deleteSelectedDel=document.getElementById('delete-selected-del'), delSearch=document.getElementById('deliverable-grid-search');
    function renderDeliverables(){
      const q=delSearch.value.toLowerCase();
      const filtered=deliverables.filter(d=>d.name.toLowerCase().includes(q)||d.cohort.toLowerCase().includes(q));
      renderGrid(delGrid, filtered, ['name','cohort','bundle','schedule','nextRun','lastRunStatus']);
      deleteSelectedDel.disabled=true;
      document.getElementById('del-select-all').checked=false;
      delGrid.querySelectorAll('input[type="checkbox"]').forEach(cb=>cb.onchange=()=>deleteSelectedDel.disabled=!delGrid.querySelectorAll('input[type="checkbox"]:checked').length);
      delGrid.querySelectorAll('.delete').forEach(btn=>{
        btn.onclick=()=>{
          const name=btn.dataset.name;
          if(confirm(`Delete deliverable "${name}"?`)){
            deliverables=deliverables.filter(d=>d.name!==name); renderDeliverables();
          }
        };
      });
      delGrid.querySelectorAll('.update').forEach(btn=>{
        btn.onclick=()=>openDeliverableWizard('edit', btn.dataset.name);
      });
    }
    delSearch.oninput=renderDeliverables;
    renderDeliverables();
    document.getElementById('del-select-all').onclick=e=>{
      const c=e.target.checked;
      delGrid.querySelectorAll('input[type="checkbox"]').forEach(cb=>cb.checked=c);
      deleteSelectedDel.disabled=!c;
    };
    deleteSelectedDel.onclick=()=>{
      const sel=Array.from(delGrid.querySelectorAll('input[type="checkbox"]:checked')).map(cb=>cb.dataset.name);
      if(!sel.length){alert('None selected');return;}
      if(confirm(`Delete ${sel.length} deliverables?`)){ sel.forEach(n=>deliverables=deliverables.filter(d=>d.name!==n)); renderDeliverables(); }
    };

    // Wizards Logic for Submission & Review (edit support)
    const lwOverlay=document.getElementById('lib-wizard-overlay'), rlOverlay=document.getElementById('rlib-wizard-overlay');
    let lwState={step:1,mode:'create',editItem:null,name:'',endpoint:'',auth:'',schema:''};
    let rlState={step:1,mode:'create',editItem:null,name:'',endpoint:'',auth:'',schema:''};
    function showLibStep(){
      [1,2].forEach(s=>document.getElementById('lw-step-'+s).classList.remove('active'));
      document.getElementById('lw-step-'+lwState.step).classList.add('active');
      document.getElementById('lw-prev').style.display=lwState.step>1?'inline-block':'none';
      document.getElementById('lw-next').style.display=lwState.step<2?'inline-block':'none';
      document.getElementById('lw-finish').style.display=lwState.step===2?'inline-block':'none';
      if(lwState.step===2){
        document.getElementById('lw-review-name').textContent=lwState.name;
        document.getElementById('lw-review-endpoint').textContent=lwState.endpoint;
        document.getElementById('lw-review-auth').textContent=lwState.auth;
        document.getElementById('lw-review-schema').textContent=lwState.schema;
      }
    }
    document.getElementById('open-lib-wizard').onclick=()=>{
      lwState={step:1,mode:'create',editItem:null,name:'',endpoint:'',auth:'',schema:''};
      ['lw-name','lw-endpoint','lw-auth','lw-schema'].forEach(id=>document.getElementById(id).value='');
      document.getElementById('lw-name-error').textContent='';
      document.getElementById('lw-endpoint-error').textContent='';
      lwOverlay.style.display='flex'; showLibStep();
    };
    function openLibWizard(mode,name){
      const item=submissionLibrary.find(it=>it.name===name);
      lwState={step:1,mode:'edit',editItem:item,name:item.name,endpoint:item.endpoint,auth:item.auth,schema:item.schema};
      document.getElementById('lw-name').value=item.name;
      document.getElementById('lw-endpoint').value=item.endpoint;
      document.getElementById('lw-auth').value=item.auth;
      document.getElementById('lw-schema').value=item.schema;
      lwOverlay.style.display='flex'; showLibStep();
    }
    document.getElementById('lw-cancel').onclick=()=>{ lwOverlay.style.display='none'; };
    document.getElementById('lw-validate').onclick=()=>{
      document.getElementById('lw-validate-status').textContent='Running tests...';
      setTimeout(()=>document.getElementById('lw-validate-status').textContent='Validation passed',500);
    };
    document.getElementById('lw-next').onclick=()=>{
      lwState.name=document.getElementById('lw-name').value.trim();
      lwState.endpoint=document.getElementById('lw-endpoint').value.trim();
      document.getElementById('lw-name-error').textContent=lwState.name?'':'Name required';
      document.getElementById('lw-endpoint-error').textContent=lwState.endpoint?'':'Endpoint URL required';
      if(!lwState.name||!lwState.endpoint) return;
      lwState.auth=document.getElementById('lw-auth').value;
      lwState.schema=document.getElementById('lw-schema').value.trim();
      lwState.step++; showLibStep();
    };
    document.getElementById('lw-prev').onclick=()=>{
      if(lwState.step>1) lwState.step--; showLibStep();
    };
    document.getElementById('lw-finish').onclick=()=>{
      if(lwState.mode==='create'){
        submissionLibrary.push({id:Date.now().toString(),name:lwState.name,endpoint:lwState.endpoint,auth:lwState.auth,schema:lwState.schema,lastValidationStatus:'Pending'});
      } else {
        lwState.editItem.name=lwState.name; lwState.editItem.endpoint=lwState.endpoint; lwState.editItem.auth=lwState.auth; lwState.editItem.schema=lwState.schema;
      }
      renderSubmissionLibrary(); lwOverlay.style.display='none';
    };

    function showRLibStep(){
      [1,2].forEach(s=>document.getElementById('rlw-step-'+s).classList.remove('active'));
      document.getElementById('rlw-step-'+rlState.step).classList.add('active');
      document.getElementById('rlw-prev').style.display=rlState.step>1?'inline-block':'none';
      document.getElementById('rlw-next').style.display=rlState.step<2?'inline-block':'none';
      document.getElementById('rlw-finish').style.display=rlState.step===2?'inline-block':'none';
      if(rlState.step===2){
        document.getElementById('rlw-review-name').textContent=rlState.name;
        document.getElementById('rlw-review-endpoint').textContent=rlState.endpoint;
        document.getElementById('rlw-review-auth').textContent=rlState.auth;
        document.getElementById('rlw-review-schema').textContent=rlState.schema;
      }
    }
    document.getElementById('open-rlib-wizard').onclick=()=>{
      rlState={step:1,mode:'create',editItem:null,name:'',endpoint:'',auth:'',schema:''};
      ['rlw-name','rlw-endpoint','rlw-auth','rlw-schema'].forEach(id=>document.getElementById(id).value='');
      document.getElementById('rlw-name-error').textContent='';
      document.getElementById('rlw-endpoint-error').textContent='';
      rlOverlay.style.display='flex'; showRLibStep();
    };
    function openRLibWizard(mode,name){
      const item=reviewLibrary.find(it=>it.name===name);
      rlState={step:1,mode:'edit',editItem:item,name:item.name,endpoint:item.endpoint,auth:item.auth,schema:item.schema};
      document.getElementById('rlw-name').value=item.name;
      document.getElementById('rlw-endpoint').value=item.endpoint;
      document.getElementById('rlw-auth').value=item.auth;
      document.getElementById('rlw-schema').value=item.schema;
      rlOverlay.style.display='flex'; showRLibStep();
    }
    document.getElementById('rlw-cancel').onclick=()=>{ rlOverlay.style.display='none'; };
    document.getElementById('rlw-validate').onclick=()=>{
      document.getElementById('rlw-validate-status').textContent='Running tests...';
      setTimeout(()=>document.getElementById('rlw-validate-status').textContent='Validation passed',500);
    };
    document.getElementById('rlw-next').onclick=()=>{
      rlState.name=document.getElementById('rlw-name').value.trim();
      rlState.endpoint=document.getElementById('rlw-endpoint').value.trim();
      document.getElementById('rlw-name-error').textContent=rlState.name?'':'Name required';
      document.getElementById('rlw-endpoint-error').textContent=rlState.endpoint?'':'Endpoint URL required';
      if(!rlState.name||!rlState.endpoint) return;
      rlState.auth=document.getElementById('rlw-auth').value;
      rlState.schema=document.getElementById('rlw-schema').value.trim();
      rlState.step++; showRLibStep();
    };
    document.getElementById('rlw-prev').onclick=()=>{
      if(rlState.step>1) rlState.step--; showRLibStep();
    };
    document.getElementById('rlw-finish').onclick=()=>{
      if(rlState.mode==='create'){
        reviewLibrary.push({id:Date.now().toString(),name:rlState.name,endpoint:rlState.endpoint,auth:rlState.auth,schema:rlState.schema,lastValidationStatus:'Pending'});
      } else {
        rlState.editItem.name=rlState.name; rlState.editItem.endpoint=rlState.endpoint; rlState.editItem.auth=rlState.auth; rlState.editItem.schema=rlState.schema;
      }
      renderReviewLibrary(); rlOverlay.style.display='none';
    };

    // Cohort, Bundle, Deliverable Wizards logic (unchanged)
  </script>
</body>
</html>